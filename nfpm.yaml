# nfpm configuration file for building .deb and .rpm packages
# https://nfpm.goreleaser.com/configuration/

name: meshtastic-relay
arch: "${GOARCH}"
platform: linux
version: "${VERSION}"
section: net
priority: optional
maintainer: iamruinous <iamruinous@users.noreply.github.com>
description: |
  Meshtastic Message Relay Service
  A service that listens for messages from Meshtastic nodes and forwards
  them to configurable endpoints (Apprise, filesystem, stdout, webhooks).
vendor: iamruinous
homepage: https://github.com/iamruinous/meshtastic-message-relay
license: MIT

contents:
  # Binary
  - src: dist/meshtastic-relay-linux-${GOARCH_SUFFIX}
    dst: /usr/bin/meshtastic-relay
    file_info:
      mode: 0755

  # Example configuration
  - src: configs/example.yaml
    dst: /etc/meshtastic-relay/config.yaml.example
    type: config
    file_info:
      mode: 0644

  # Systemd service file
  - src: packaging/meshtastic-relay.service
    dst: /usr/lib/systemd/system/meshtastic-relay.service
    file_info:
      mode: 0644

  # Create config directory
  - dst: /etc/meshtastic-relay
    type: dir
    file_info:
      mode: 0755

  # Create log directory
  - dst: /var/log/meshtastic-relay
    type: dir
    file_info:
      mode: 0755

scripts:
  postinstall: packaging/postinstall.sh
  preremove: packaging/preremove.sh

overrides:
  deb:
    depends:
      - libc6
  rpm:
    depends:
      - glibc
